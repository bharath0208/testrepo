# This file is used by the integration tests in the 'service' directory
tests {
  scheme = https
  host = localhost
  port = 18804
  iam {
    "apikey": ${WML_API_KEY}
    # required to look up the IAM token
    "token_server": "https://iam.test.cloud.ibm.com/identity/token"
    "authorization": "Basic Yng6Yng="
  }
  v3repo {
    url = ${?WML_V3_REPO}
  }
}

migration.host = "https://"${WML_HOST}
cluster.url = "https://"${CLUSTER_HOST}
client.auth = ${CLIENT_AUTH}
service.token = ${?SERVICE_ID_CREDENTIALS}
service.platform.icp.token = ${?SERVICE_ID_CREDENTIALS}

icp {
  token {
    username = "admin"
    password = "password"
    url = "https://"${CLUSTER_HOST}
  }
}

service {
  validateTokenService.ml.pubkey.path = ../service/keystore/mykey_pub.pem
  validateTokenService.icp.pubkey.path = ../service/keystore/mykey_local.pem
  wml.auth = ${WML_AUTH}

  wml {
      host = ${WML_HOST} #used in migration code invoked by tests
      port = ${WML_PORT}
      private {
        host = ${WML_PRIVATE_HOST}
        port = ${WML_PORT}
      }
  }

  host = "https://"${WML_HOST} #used in the test code

  platform {
    host = ${PLATFORM_HOST}
    port = ${PLATFORM_PORT}
  }
  
  wml_instances_v4 {
    url = "https://"${WML_HOST}"/ml/v4/instances"
  }
  
  wml_instances {
    url = "https://"${WML_HOST}"/v4/instances"
  }

  cloudant {
    host = ${?WML_CLOUDANT_HOSTNAME}
    port = 443
    username = ${?WML_CLOUDANT_USERNAME}
    password = ${?WML_CLOUDANT_PASSWORD}
    dbName = ${?WML_CLOUDANT_DBNAME}
  }
}

akka {
  http {
    host-connection-pool {
      # Set to `infinite` to completely disable idle connection timeouts.
      idle-timeout = 180 s
    }
    log-dead-letters = 10
    log-dead-letters-during-shutdown = on
  }
}
